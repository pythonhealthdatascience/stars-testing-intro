---
title: "How to write a basic test"
---

```{r}
#| include: false
library(reticulate)
use_condaenv("hdruk_tests", required = TRUE)
```

{{< include /assets/language-selector.html >}}

<br>

::: {.python-content}

On this page, we explain how to write a basic automated test in Python using **pytest**.

## What is pytest?

Pytest is a popular framework for testing in Python, widely used in software development and data science.

You should install the `pytest` package into your environment from either conda or PyPI:

```{.bash}
conda install pytest
# or
pip install pytest
```

## What a pytest test looks like

In pytest, any function whose name starts with `test_` is treated as a test. Inside the function you write one or more `assert` statements. If an assertion fails, pytest will return an error message explaining what went wrong.

For example:

```{python}
import pytest


def test_example():
    """Simple test confirming 2 + 2 = 4"""
    result = 2 + 2
    assert result == 4
```

:::

::: {.r-content}

On this page, we explain how to write a basic automated test in R using **testthat**.

## testthat

testthat is a popular framework for testing in R, widely used in software development and data science.

You should install the `testthat` package into your environment from CRAN.

```{.r}
install.packages("testthat")
```

## What a testthat test looks like

Tests are created using `test_that()`. They are built around expectations like `expect_true()`, `expect_false()`, `expect_equal()`, `expect_error()`, and others (see [package index](https://testthat.r-lib.org/reference/index.html) for more).

## Simple test example

```{r}
library(testthat)


test_that("2 add 2 equals 4", {
  result <- 2L + 2L
  expect_equal(result, 4L)
})
```

:::

<div style="margin-top: 3em"></div>

## A simple test for `summary_stats`

Here is a minimal example using the `summary_stats` function from the case study.

:::: {.python-content}

::: {.callout-note title="View `summary_stats()`" collapse="true"}

```{python}
#| file: code/patient_analysis__summary_stats.py
#| execute: false
```

:::

::::

For a single value, the function should return that value as the mean and `NaN` for the other statistics, because there is not enough data to define a standard deviation or confidence interval.

:::: {.python-content}

```{python}
#| file: code/test_intro_simple__imports.py
#| execute: false
```

```{python}
#| file: code/test_intro_simple__test_summary_stats_single_value.py
#| execute: false
```

::::

::: {.r-content}

TODO.

:::

<br>